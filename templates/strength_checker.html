<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Strength Checker</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
    /* ---------------------- THEME VARIABLES (Keep as is) ---------------------- */
    :root {
        --color-primary: #1e88e5; /* Blue */
        --color-primary-hover: #1565c0;
        --color-background: #f0f2f5; /* Light Gray Background */
        --color-surface: #ffffff; /* White Card/Container */
        --color-surface-secondary: #f9f9f9; /* Lighter background */
        --color-text: #212121; /* Dark Text */
        --color-text-secondary: #757575;
        --color-border: #e0e0e0;
        --color-success: #4caf50;
        --color-failure: #e53935;
        --color-warning: #ff9800;
        --color-shadow: rgba(0, 0, 0, 0.1); /* Added from index.html */
    }
    [data-theme='dark'] {
        --color-primary: #64b5f6;
        --color-primary-hover: #42a5f5;
        --color-background: #0d1117; /* GitHub Dark */
        --color-surface: #161b22; /* Dark Card/Container */
        --color-surface-secondary: #21262d; /* Lighter dark background */
        --color-text: #e0e0e0; /* Light Text */
        --color-text-secondary: #bdbdbd;
        --color-border: #303030;
        --color-success: #81c784;
        --color-failure: #e57373;
        --color-warning: #ffb74d;
        --color-shadow: rgba(255, 255, 255, 0.05); /* Added from index.html */
    }

    /* ---------------------- BASE STYLES & LAYOUT (Keep as is) ---------------------- */
    * {
        box-sizing: border-box;
        transition: background-color 0.4s, color 0.4s, border-color 0.4s, box-shadow 0.4s, transform 0.4s;
        font-family: 'Inter', sans-serif;
    }
    body {
        margin: 0;
        padding: 0;
        background-color: var(--color-background);
        color: var(--color-text);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center; /* Center vertically */
        padding: 30px;
    }
    .container {
        max-width: 600px; /* Adjusted max-width */
        width: 100%;
        margin: auto;
        padding: 40px;
        background: var(--color-surface);
        border-radius: 16px;
        box-shadow: 0 15px 40px var(--color-shadow);
        position: relative;
        opacity: 0;
        animation: fadeIn 0.8s ease-out forwards;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    h1 {
        color: var(--color-text);
        font-weight: 700;
        font-size: 2em;
        text-align: center;
        padding-bottom: 0.5em;
        margin-top: 0;
        margin-bottom: 1.5em;
        border-bottom: 3px solid var(--color-primary); /* Added border */
    }
     p { line-height: 1.6; }
     a.button-link { /* Style for the 'Back' link */
        display: inline-block;
        margin-bottom: 1.5em; /* More space below */
        color: var(--color-primary);
        text-decoration: none;
        font-weight: 600;
        padding: 0.5em 0; /* Add some padding if needed */
    }
    a.button-link:hover { text-decoration: underline; }

    /* ---------------------- FORM GROUP & INPUT STYLES (Decorated) ---------------------- */
    .form-group {
        margin-bottom: 1.5em;
        padding: 1.5em;
        border: 1px solid var(--color-border);
        border-radius: 10px;
        background-color: var(--color-surface-secondary);
        /* Added for better layout of input + button */
        display: flex;
        align-items: center;
        flex-wrap: wrap; /* Allow wrapping on small screens */
    }
    label {
        display: block;
        margin-bottom: 0.8em;
        font-weight: 600;
        color: var(--color-text);
        font-size: 1em;
        width: 100%; /* Make label take full width */
    }
    input[type="password"] {
        flex-grow: 1; /* Allow input to take available space */
        min-width: 200px; /* Prevent input from becoming too small */
        padding: 12px 15px;
        border: 1px solid var(--color-border);
        border-radius: 8px;
        background-color: var(--color-surface);
        color: var(--color-text);
        font-size: 1em;
        margin-right: 10px;
        margin-bottom: 10px; /* Add margin for wrapping */
    }
    input[type="password"]:focus {
        border-color: var(--color-primary);
        outline: none;
        box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.3);
    }

    /* ---------------------- BUTTON STYLES (Decorated) ---------------------- */
    button.button {
        display: inline-block;
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        background-color: var(--color-primary);
        color: var(--color-surface); /* Correct text color */
        font-weight: 700;
        font-size: 1em;
        cursor: pointer;
        transition: background-color 0.3s, transform 0.2s;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        white-space: nowrap; /* Prevent button text wrapping */
        margin-bottom: 10px; /* Add margin for wrapping */
    }
    button.button:hover {
        background-color: var(--color-primary-hover);
        transform: translateY(-2px);
    }

    /* ---------------------- RESULTS AREA ---------------------- */
    #strength_results {
        margin-top: 1.5em;
        padding: 1.5em;
        border-radius: 8px;
        min-height: 70px;
        background-color: var(--color-surface-secondary);
        border: 1px dashed var(--color-border);
        line-height: 1.6;
        font-size: 1.1em;
    }
     #strength_results p { margin: 0.3em 0;}

    /* ---------------------- THEME SWITCH (Keep as is) ---------------------- */
    .theme-switch-wrapper { display: flex; align-items: center; position: absolute; top: 25px; right: 25px; z-index: 10; color: var(--color-text); }
    .theme-switch { display: inline-block; height: 24px; position: relative; width: 48px; margin-left: 10px; }
    .theme-switch input { display: none; }
    .slider { background-color: var(--color-text-secondary); bottom: 0; cursor: pointer; left: 0; position: absolute; right: 0; top: 0; transition: .4s; }
    .slider:before { background-color: var(--color-surface); bottom: 4px; content: ""; height: 16px; left: 4px; position: absolute; width: 16px; transition: .4s; }
    input:checked + .slider { background-color: var(--color-primary); }
    input:checked + .slider:before { transform: translateX(24px); }
    .slider.round { border-radius: 34px; }
    .slider.round:before { border-radius: 50%; }

    /* Responsive adjustments */
     @media (max-width: 600px) {
        .form-group { flex-direction: column; align-items: stretch; }
        input[type="password"] { width: 100%; margin-right: 0; margin-bottom: 10px; }
        button.button { width: 100%; }
        .container { padding: 25px; }
        h1 { font-size: 1.8em; }
    }
</style>
</head>
<body>
    <div class="theme-switch-wrapper">
        <label for="theme-switch">Dark Mode</label>
        <label class="theme-switch" for="theme-switch">
            <input type="checkbox" id="theme-switch" />
            <div class="slider round"></div>
        </label>
    </div>

    <div class="container">
        <h1>Password Strength Checker</h1>
        <p><a href="/" class="button-link">Back to Audit Uploader</a></p>

        <div class="strength-checker-section">
            <div class="form-group">
                <label for="password_input">Enter Password:</label>
                <div><input type="password" id="password_input" name="password_input" placeholder="Type password here...">
                    <button type="button" id="check_strength_button" class="button">Analyze Strength</button>
                </div>
            </div>
            <div id="strength_results">
                </div>
        </div>
    </div>
    
    <script>
        const STORAGE_KEY = 'user-theme';
        const body = document.body;
        const themeSwitch = document.getElementById('theme-switch');

        function setTheme(theme) {
            body.setAttribute('data-theme', theme);
            localStorage.setItem(STORAGE_KEY, theme);
            themeSwitch.checked = (theme === 'dark');
        }

        const storedTheme = localStorage.getItem(STORAGE_KEY);
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        if (storedTheme) {
            setTheme(storedTheme);
        } else if (prefersDark) {
            setTheme('dark');
        } else {
            setTheme('light');
        }

        themeSwitch.addEventListener('change', (e) => {
            setTheme(e.target.checked ? 'dark' : 'light');
        });
    </script>

    <script>
        const passwordInput = document.getElementById('password_input');
        const checkButton = document.getElementById('check_strength_button');
        const resultsDiv = document.getElementById('strength_results');

        checkButton.addEventListener('click', () => {
            const password = passwordInput.value;
            resultsDiv.textContent = 'Analyzing...'; // Provide feedback
            resultsDiv.style.backgroundColor = 'var(--color-surface-light)'; // Reset background

            fetch('/check_strength', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ password: password }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    resultsDiv.textContent = `Error: ${data.error}`;
                    resultsDiv.style.backgroundColor = 'rgba(229, 57, 53, 0.1)'; // Error color
                } else {
                    // Display similar to Bitwarden
                    let strengthColor = 'var(--color-failure)'; // Default weak
                    if (data.strength === "Moderate") strengthColor = 'var(--color-warning)';
                    else if (data.strength === "Strong") strengthColor = 'var(--color-success)';
                    else if (data.strength === "Very Strong") strengthColor = 'var(--color-success)';

                    resultsDiv.innerHTML = `
                        <p style="margin: 0;"><strong>Strength:</strong> <span style="color: ${strengthColor}; font-weight: bold;">${data.strength}</span></p>
                        <p style="margin: 5px 0 0 0;"><strong>Estimated Time to Crack:</strong> ${data.crack_time}</p>
                    `;
                    resultsDiv.style.backgroundColor = 'var(--color-surface-light)';
                }
            })
            .catch(error => {
                console.error('Error:', error);
                resultsDiv.textContent = 'An error occurred while checking strength.';
                resultsDiv.style.backgroundColor = 'rgba(229, 57, 53, 0.1)';
            });
        });
    </script>
</body>
</html>